@model ShopNow.ViewModels.MedicalCreateViewModel
@{
    ViewBag.Title = "Medical Entry";
}
<title>ShopNow | @ViewBag.Title</title>
<style>
    .select2 {
        width: 100% !important;
    }
</style>
@using (Html.BeginForm("MedicalCreate", "Product", FormMethod.Post, new { id = "ProductForm", role = "form", enctype = "multipart/form-data", autocomplete = "off" }))
{
    @Html.AntiForgeryToken()
    <div class="container-fluid my-0">
        <div class="row">
            <div class="col-md-6">
                <h5 class="mt-1 text-success" style="letter-spacing:1px">@ViewBag.Title</h5>
            </div>
            <div class="col-md-6 text-right">
                <a href="~/Product/MedicalList" target="_self"><span class="fa fa-list-ul"></span> Medical List</a>&nbsp;&nbsp;
                <a href="~/Product/List" target="_blank"><span class="fa fa-list-ul"></span> Full List</a>
            </div>
        </div>
        <div class="card shadow mb-3">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-2 text-md-left">
                        <label class="col-form-label text-secondary font-weight-bold">Shop Name</label>
                    </div>
                    <div class="col-md-4">
                        <select id="ShopId" name="ShopId" class="form-control"></select>
                        <input type="hidden" name="ShopName" id="ShopName" />
                    </div>
                </div>
            </div>
        </div>
        <div class="card shadow">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <label class="control-label">
                            <span class="text-secondary font-weight-bold">Drug Name</span>
                        </label>
                        <div class="form-group">
                            <div class="Select2Name">
                                <select id="MasterProductId" name="MasterProductId" class="form-control"></select>
                                <input type="hidden" name="MasterProductName" id="MasterProductName" />
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label text-secondary font-weight-bold" for="BrandId">Brand Name</label>
                        <div class="form-group">
                            <input type="hidden" name="BrandId" id="BrandId" />
                            <input type="text" class="form-control" name="BrandName" id="BrandName" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label text-secondary font-weight-bold" for="CategoryId">Category Name</label>
                        <div class="form-group">
                            <input type="hidden" name="CategoryId" id="CategoryId" />
                            <input type="text" class="form-control" name="CategoryName" id="CategoryName" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label text-secondary font-weight-bold" for="MeasurementUnitId">Drug Measurement Unit Name</label>
                        <div class="form-group">
                            <input type="hidden" name="MeasurementUnitId" id="MeasurementUnitId" />
                            <input type="text" class="form-control" name="MeasurementUnitName" id="MeasurementUnitName" readonly />
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="control-label text-secondary font-weight-bold" for="DrugCompoundDetailIds">Combination DrugCompound</label>
                        <div class="form-group">
                            <input type="text" class="form-control" name="DrugCompoundDetailName" id="DrugCompoundDetailName" readonly />
                            <input type="hidden" name="DrugCompoundDetailIds" id="DrugCompoundDetailIds" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Prescription</strong></label>
                            <select class="form-control" name="PriscriptionCategory" id="PriscriptionCategory" disabled>
                                <option value="Select">Select Prescription</option>
                                <option value="true">Rx Required</option>
                                <option value="false">Rx Not Required</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">iBarU</strong></label>
                            <input type="text" class="form-control" name="IBarU" id="IBarU" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label" for="MenuPrice"><strong class="text-secondary">Menu Price</strong></label>
                            <input id="MenuPrice" type="number" class="form-control" step="any" name="MenuPrice" min="1" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label" for="Price"><strong class="text-secondary">Selling Price</strong></label>
                            <input id="Price" type="number" class="form-control" step="any" name="Price" min="1" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label" for="Percentage"><strong class="text-secondary">Percentage</strong></label>
                            <input id="Percentage" type="number" class="form-control" step="any" name="Percentage" min="1" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label" for="Qty"><strong class="text-secondary">Quantity</strong></label>
                            <input id="Qty" type="number" class="form-control" name="Qty" min="1" value="1" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label text-secondary font-weight-bold" for="DiscountCategoryId">Discount Category Name</label>
                        <div class="form-group">
                            <select class="form-control" name="DiscountCategoryId" id="DiscountCategoryId"></select>
                            <input type="hidden" name="DiscountCategoryName" id="DiscountCategoryName" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label" for="DiscountCategoryPercentage"><strong class="text-secondary">Discount Percentage</strong></label>
                            <input type="number" class="form-control" name="DiscountCategoryPercentage" id="DiscountCategoryPercentage" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Weight</strong></label>
                            <input type="number" class="form-control" name="Weight" id="Weight" step="any" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Size</strong></label>
                            <input type="text" class="form-control" name="SizeLB" id="SizeLB" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Package Name</strong></label>
                            <input type="text" class="form-control" name="PackageName" id="PackageName" readonly />
                            <input type="hidden" name="PackageId" id="PackageId" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label" for="GoogleTaxonomyCode"><strong class="text-secondary">Google Taxonomy Code</strong></label>
                        <input id="GoogleTaxonomyCode" type="text" class="form-control" name="GoogleTaxonomyCode" readonly />
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Manufacturer</strong></label>
                            <input type="text" class="form-control" name="Manufacturer" id="Manufacturer" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Origin Country</strong></label>
                            <input type="text" class="form-control" name="OriginCountry" id="OriginCountry" readonly />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label" for="PackingType"><strong class="text-secondary">Packing Type</strong></label>
                        <div class="form-check-inline ml-3">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="PackingType" value="0" checked>Item Qty
                            </label>
                        </div>
                        <div class="form-check-inline">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="PackingType" value="1">SKU
                            </label>
                        </div>
                        <input type="number" class="form-control" name="PackingCharge" id="PackingCharge" />
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="control-label"><strong class="text-secondary">Loyalty Points per 100 Value</strong></label>
                            <input type="number" class="form-control" name="LoyaltyPoints" id="LoyaltyPoints" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label"><strong class="text-secondary">Tax %</strong></label>
                        <div class="form-group">
                            <input type="number" class="form-control" name="TaxPercentage" id="TaxPercentage" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label class="control-label"><strong class="text-secondary">Special Cost Of Delivery</strong></label>
                        <div class="form-group">
                            <input type="number" class="form-control" name="SpecialCostOfDelivery" id="SpecialCostOfDelivery" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card my-3">
            <div class="card-body">
                <div class="row mt-2">
                    <h5 class="text-success">Drug Image(s)</h5>
                </div>
                <div class="row mt-2">
                    <div class="col-md-2">
                        <label class="control-label"><strong class="text-secondary">Product Image1</strong></label>
                        <img class="img-container" id="img-ProductImage1" src="/Images/No Photo.png" onerror="this.src='/Images/No Photo.png'" style="width:120px;height:120px;" />
                    </div>
                    <div class="col-md-2">
                        <label class="control-label"><strong class="text-secondary">Product Image2</strong></label>
                        <img class="img-container" id="img-ProductImage2" src="/Images/No Photo.png" onerror="this.src='/Images/No Photo.png'" style="width:120px;height:120px;" />
                    </div>
                    <div class="col-md-2">
                        <label class="control-label"><strong class="text-secondary">Product Image3</strong></label>
                        <img class="img-container" id="img-ProductImage3" src="/Images/No Photo.png" onerror="this.src='/Images/No Photo.png'" style="width:120px;height:120px;" />
                    </div>
                    <div class="col-md-2">
                        <label class="control-label"><strong class="text-secondary">Product Image4</strong></label>
                        <img class="img-container" id="img-ProductImage4" src="/Images/No Photo.png" onerror="this.src='/Images/No Photo.png'" style="width:120px;height:120px;" />
                    </div>
                    <div class="col-md-2">
                        <label class="control-label"><strong class="text-secondary">Product Image5</strong></label>
                        <img class="img-container" id="img-ProductImage5" src="/Images/No Photo.png" onerror="this.src='/Images/No Photo.png'" style="width:120px;height:120px;" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3 mx-auto">
                        <button type="button" class="btn btn-block btn-success Save"><span class="glyphicon glyphicon-file"></span> Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
@*Image Modal*@
<div id="myModal" class="modal fade">
    <div class="modal-dialog">
        <span class="close" data-dismiss="modal">&times;</span>
        <img class="modal-content" id="myImage">
    </div>
</div>

@section Scripts
{
    <!--Select2-->
    <script src="~/Scripts/select2/js/select2.js"></script>
    <link href="~/Scripts/select2/css/select2.css" rel="stylesheet" />
    <link href="~/Content/select2/select2.custom.css" rel="stylesheet" />
    <!--Select2 End-->
    <script src="~/Scripts/ckeditor/ckeditor.js"></script>
    <script src="~/Scripts/multiple-image-upload.js"></script>
    <link href="~/Content/multiple-image-upload.css" rel="stylesheet" />
    <script src="~/Scripts/sweetalert/sweetalert.min.js"></script>
    <link href="~/Content/sweetalert/sweetalert.css" rel="stylesheet" />
    <script>
            $(document).ready(function () {

                $("#AddStock").on('click', function () {
                    $("#divStock").toggleClass('d-none');
                });

                var errormsg = "@ViewBag.ErrorMessage";
                var msg = "@ViewBag.Message";
                if (errormsg != "") {
                    swal("Notice!", errormsg, "warning")
                }
                if (msg != "") {
                    swal("Success!", msg, "success")
                }

                $('#Price').on('change keyup', function () {
                    var menuprice = $("#MenuPrice").val();
                    var sellingprice = $(this).val();
                    var results = Math.ceil(((menuprice - sellingprice) / menuprice) * 100);
                    $("#Percentage").val(results);
                });

                $('#MenuPrice').on('change keyup', function () {
                    var menuprice = $(this).val();
                    var sellingprice = $('#Price').val();
                    var results = Math.ceil(((menuprice - sellingprice) / menuprice) * 100);
                    $("#Percentage").val(results);
                });

                $('#ShopId').select2({
                    placeholder: "Search Shop",
                    ajax: {
                        url: "/Product/GetMedicalShopSelect2",
                        width: '100%',
                        delay: 250,
                        dataType: 'json'
                    }
                }).on('select2:select', function (e) {
                    $('input[name="ShopName"]').val(e.params.data.shopname);
                });

                $('#DiscountCategoryId').select2({
                    placeholder: "Search Discount Category",
                    ajax: {
                        url: "/Product/GetDiscountCategorySelect2",
                        width: '100%',
                        delay: 250,
                        dataType: 'json'
                    }
                }).on('select2:select', function (e) {
                    $('input[name="DiscountCategoryName"]').val(e.params.data.text);
                    $('input[name="DiscountCategoryPercentage"]').val(e.params.data.percentage);
                });

                $(".Save").click(function () {
                    var shopcode = $("#ShopId").val();
                    if (shopcode != null) {
                        $('#ProductForm').submit();
                    } else {
                        swal("Notice!", "Please Select Shop Name!", "warning");
                    }
                });

                $('#MasterProductId').select2({
                    placeholder: "Search Drug",
                    ajax: {
                        url: "/Product/GetMedicalSelect2",
                        width: '100%',
                        delay: 250,
                        dataType: 'json'
                    }
                }).on('select2:select', function (e) {
                    var code = e.params.data.id;
                    $('input[name="MasterProductName"]').val(e.params.data.text);
                    $('input[name="CategoryId"]').val(e.params.data.CategoryId);
                    $('input[name="BrandId"]').val(e.params.data.BrandId);
                    $('input[name="BrandName"]').val(e.params.data.BrandName);
                    $('input[name="MeasurementUnitId"]').val(e.params.data.MeasurementUnitId);
                    $('input[name="MeasurementUnitName"]').val(e.params.data.MeasurementUnitName);
                    $('input[name="DrugCompoundDetailIds"]').val(e.params.data.DrugCompoundDetailIds);
                    $('input[name="DrugCompoundDetailName"]').val(e.params.data.DrugCompoundDetailName);
                    $('input[name="PackageId"]').val(e.params.data.PackageId);
                    $('input[name="PackageName"]').val(e.params.data.PackageName);
                    $('input[name="Manufacturer"]').val(e.params.data.Manufacturer);
                    $('input[name="OriginCountry"]').val(e.params.data.OriginCountry);
                    $('input[name="IBarU"]').val(e.params.data.iBarU);
                    $('input[name="Weight"]').val(e.params.data.weight);
                    $('input[name="SizeLB"]').val(e.params.data.SizeLB);
                    $('input[name="MenuPrice"]').val(e.params.data.Price);
                    $('input[name="GoogleTaxonomyCode"]').val(e.params.data.GoogleTaxonomyCode);
                    $('select[name^="PriscriptionCategory"] option[value="' + e.params.data.PriscriptionCategory + '"]').attr("selected", "selected");
                    $('#img-ProductImage1').attr('src', 'https://s3.ap-south-1.amazonaws.com/shopnowchat.com/Medium/' + e.params.data.ImagePath1);
                    $('#img-ProductImage2').attr('src', 'https://s3.ap-south-1.amazonaws.com/shopnowchat.com/Medium/' + e.params.data.ImagePath2);
                    $('#img-ProductImage3').attr('src', 'https://s3.ap-south-1.amazonaws.com/shopnowchat.com/Medium/' + e.params.data.ImagePath3);
                    $('#img-ProductImage4').attr('src', 'https://s3.ap-south-1.amazonaws.com/shopnowchat.com/Medium/' + e.params.data.ImagePath4);
                    $('#img-ProductImage5').attr('src', 'https://s3.ap-south-1.amazonaws.com/shopnowchat.com/Medium/' + e.params.data.ImagePath5);
                    if (e.params.data.CategoryId != 0) {
                        $.getJSON("/Product/GetCategoryName", { categoryId: e.params.data.CategoryId }, function (data) {
                            $('#CategoryName').val(data.categoryName);
                        });
                    }
                });
            });
    </script>
}

